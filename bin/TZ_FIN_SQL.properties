
fin01_001=SELECT f.folno AS typeno,g.gctnm,g.gctid,i.ictnm AS ictnm,i.ictid AS ictid,p.pdtid AS pdtid,p.pdtnm AS pdtnm,nvl(r.series,'\u914D\u4EF6') as band,m.tmksid AS tmksid,p.pdtprc AS pdtprc, d.fdtprc as sellprc,d.fdtqnt as pdtnum,NVL(r.rate,'0.4') as finrate,f.folchgdt as chgdt,(pdtprc*nvl(r.rate,'0.4')) as finprc,(pdtprc*fdtqnt*nvl(r.rate,'0.4')) as finprccount FROM tblfolio f LEFT JOIN tblfoldetail d ON f.folno = d.fdtfno LEFT JOIN tblgrpclient g ON g.gctid = f.folctid LEFT JOIN tblproduct p ON p.pdtid = d.fdtpid LEFT JOIN TBLINDCLIENT i ON i.ictid = d.fdtcltid LEFT JOIN tblmaking m ON d.fdtfno = m.tmkfno LEFT JOIN TBLFINRATE r ON p.pdtnm like '%'||r.band||'%'  WHERE (f.isfinbill IS NULL OR f.isfinbill = '0') AND ((f.foltype = 'make' OR f.foltype = 'makeEar' OR f.foltype = 'normal') AND f.folischg = '1' AND ( f.folsta <> 'recoiled' AND f.folsta <> 'recoiledhead' AND f.folsta <> 'recpass')) and f.foldt > to_date('2011-12-26','yyyy-mm-dd') and f.folchgdt > (LAST_DAY(ADD_MONTHS(SYSDATE, -2))) and f.folchgdt <(LAST_DAY(ADD_MONTHS(SYSDATE, -1))+25) and f.folno =:typeno! and g.gctnm =:gctnm! and i.ictnm =:ictnm! and p.pdtid =:pdtid! and f.folchgdt>=:start! and f.folchgdt<=:end!
fin01_002=SELECT n.chgid AS typeno,g.gctnm,g.gctid,i.ictnm AS ictnm,i.ictid AS ictid,p.pdtid AS pdtid,p.pdtnm AS pdtnm,nvl(r.series,'\u914D\u4EF6') as band,p.pdtprc AS pdtprc,(p.pdtprc*h.ncddis) as sellprc,h.ncdqnt as pdtnum,NVL(r.rate,'0.4') as finrate,n.chgdt as chgdt,(pdtprc*nvl(r.rate,'0.4')) as finprc,(pdtprc*ncdqnt*nvl(r.rate,'0.4')) as finprccount FROM tblnorchg n LEFT JOIN tblnorchgdetail h ON n.chgid = h.ncdid LEFT JOIN tblgrpclient g ON g.gctid = n.chggcltid LEFT JOIN tblproduct p ON p.pdtid = h.ncdpid LEFT JOIN TBLINDCLIENT i ON i.ictid = n.chgcltid LEFT JOIN TBLFINRATE r ON p.pdtnm like '%'||r.band||'%'  WHERE (n.isfinbill is null or n.isfinbill = '0') and (h.ncdsta <> 'nomrecoiled' and h.ncdsta <> 'commited' and h.ncdsta <> 'pass') and n.chgdt > (LAST_DAY(ADD_MONTHS(SYSDATE, -2))) and n.chgdt <(LAST_DAY(ADD_MONTHS(SYSDATE, -1))+25) and n.chgid =:typeno! and g.gctnm =:gctnm! and i.ictnm =:ictnm! and p.pdtid =:pdtid! and n.chgdt>=:start! and n.chgdt<=:end!
fin01_003=SELECT f.folno AS typeno,g.gctnm,g.gctid,i.ictnm AS ictnm,i.ictid AS ictid,p.pdtid AS pdtid,p.pdtnm AS pdtnm,nvl(r.series,'\u914D\u4EF6') as band,m.tmksid AS tmksid,p.pdtprc AS pdtprc,(d.fdtdprc*d.fdtdisc) as sellprc,d.fdtqnt as pdtnum,NVL(r.rate,'0.4') as finrate,f.folchgdt as chgdt,d.fdtodt as redt,(pdtprc*nvl(r.rate,'0.4')) as finprc,(pdtprc*fdtqnt*nvl(r.rate,'0.4')) as finprccount FROM tblfolio f LEFT JOIN tblfoldetail d ON f.folno = d.fdtfno LEFT JOIN tblgrpclient g ON g.gctid = f.folctid LEFT JOIN tblproduct p ON p.pdtid = d.fdtpid LEFT JOIN TBLINDCLIENT i ON i.ictid = d.fdtcltid LEFT JOIN tblmaking m ON d.fdtfno = m.tmkfno LEFT JOIN TBLFINRATE r ON p.pdtnm like '%'||r.band||'%'  WHERE f.folischg='1' and f.isfinbill = '1' and (f.isfinredbill is null or f.isfinredbill = '0') and f.foldt > to_date('2011-12-26','yyyy-mm-dd') and n.chgdt > (LAST_DAY(ADD_MONTHS(SYSDATE, -2))) and n.chgdt <(LAST_DAY(ADD_MONTHS(SYSDATE, -1))+25) and f.folno =:typeno! and g.gctnm =:gctnm! and i.ictnm =:ictnm! and p.pdtid =:pdtid! and f.folchgdt>=:start! and f.folchgdt<=:end!
fin01_004=SELECT n.chgid AS typeno,g.gctnm,g.gctid,i.ictnm AS ictnm,i.ictid AS ictid,p.pdtid AS pdtid,p.pdtnm AS pdtnm,nvl(r.series,'\u914D\u4EF6') as band,p.pdtprc AS pdtprc,(p.pdtprc*h.ncddis) as sellprc,h.ncdqnt as pdtnum,NVL(r.rate,'0.4') as finrate,n.chgdt as chgdt,h.ncdrecdt as redt,(pdtprc*nvl(r.rate,'0.4')) as finprc,(pdtprc*ncdqnt*nvl(r.rate,'0.4')) as finprccount FROM tblnorchg n LEFT JOIN tblnorchgdetail h ON n.chgid = h.ncdid LEFT JOIN tblgrpclient g ON g.gctid = n.chggcltid LEFT JOIN tblproduct p ON p.pdtid = h.ncdpid LEFT JOIN TBLINDCLIENT i ON i.ictid = n.chgcltid LEFT JOIN TBLFINRATE r ON p.pdtnm like '%'||r.band||'%'  WHERE n.isfinbill = '1' and (n.isfinredbill is null or n.isfinredbill = '0') and n.chgid =:typeno! and g.gctnm =:gctnm! and i.ictnm =:ictnm! and p.pdtid =:pdtid! and n.chgdt>=:start! and n.chgdt<=:end!

fin01_005=SELECT f.folno AS typeno,g.gctnm,g.gctid,i.ictnm AS ictnm,i.ictid AS ictid,p.pdtid AS pdtid,p.pdtnm AS pdtnm,nvl(r.series,'\u914D\u4EF6') as band,m.tmksid AS tmksid,p.pdtprc AS pdtprc, d.fdtprc as sellprc,d.fdtqnt as pdtnum,NVL(r.rate,'0.4') as finrate,f.folchgdt as chgdt,d.fdtprc as finprc,(d.fdtprc*fdtqnt) as finprccount FROM tblfolio f LEFT JOIN tblfoldetail d ON f.folno = d.fdtfno LEFT JOIN tblgrpclient g ON g.gctid = f.folctid LEFT JOIN tblproduct p ON p.pdtid = d.fdtpid LEFT JOIN TBLINDCLIENT i ON i.ictid = d.fdtcltid LEFT JOIN tblmaking m ON d.fdtfno = m.tmkfno LEFT JOIN TBLFINRATE r ON p.pdtnm like '%'||r.band||'%'  WHERE (f.isfinbill IS NULL OR f.isfinbill = '0') AND ((f.foltype = 'make' OR f.foltype = 'makeEar' OR f.foltype = 'normal') AND f.folischg = '1' AND ( f.folsta <> 'recoiled' AND f.folsta <> 'recoiledhead' AND f.folsta <> 'recpass')) and f.foldt > to_date('2011-12-26','yyyy-mm-dd') and f.folchgdt > (LAST_DAY(ADD_MONTHS(SYSDATE, -2))) and f.folchgdt <(LAST_DAY(ADD_MONTHS(SYSDATE, -1))+25) and f.folno =:typeno! and g.gctnm =:gctnm! and i.ictnm =:ictnm! and p.pdtid =:pdtid! and f.folchgdt>=:start! and f.folchgdt<=:end!
fin01_006=SELECT n.chgid AS typeno,g.gctnm,g.gctid,i.ictnm AS ictnm,i.ictid AS ictid,p.pdtid AS pdtid,p.pdtnm AS pdtnm,nvl(r.series,'\u914D\u4EF6') as band,p.pdtprc AS pdtprc,(p.pdtprc*h.ncddis) as sellprc,h.ncdqnt as pdtnum,NVL(r.rate,'0.4') as finrate,n.chgdt as chgdt,(p.pdtprc*h.ncddis) as finprc,(p.pdtprc*h.ncddis*ncdqnt) as finprccount FROM tblnorchg n LEFT JOIN tblnorchgdetail h ON n.chgid = h.ncdid LEFT JOIN tblgrpclient g ON g.gctid = n.chggcltid LEFT JOIN tblproduct p ON p.pdtid = h.ncdpid LEFT JOIN TBLINDCLIENT i ON i.ictid = n.chgcltid LEFT JOIN TBLFINRATE r ON p.pdtnm like '%'||r.band||'%'  WHERE (n.isfinbill is null or n.isfinbill = '0') and (h.ncdsta <> 'nomrecoiled' and h.ncdsta <> 'commited' and h.ncdsta <> 'pass') and n.chgdt > (LAST_DAY(ADD_MONTHS(SYSDATE, -2))) and n.chgdt <(LAST_DAY(ADD_MONTHS(SYSDATE, -1))+25) and n.chgid =:typeno! and g.gctnm =:gctnm! and i.ictnm =:ictnm! and p.pdtid =:pdtid! and n.chgdt>=:start! and n.chgdt<=:end!


fin02_001=select distinct c.fintype,c.notype,c.gctid,c.pdtid,c.pdtnm,c.band,c.finrate,c.finprc,c.gctnm,c.finnt,sum(c.pdtnum)over(partition by c.fintype,c.gctid,c.pdtid) as pdtnum,sum(c.finprccount)over(partition by c.fintype,c.gctid,c.pdtid) as finprccount from tblfinance c where c.fintype=:fintype! and c.notype=:notype! and c.gctnm=:gctnm! and c.pdtid=:pdtid!
fin02_001_1=select distinct c.fintype,c.notype,c.gctid,c.pdtid,c.pdtnm,c.band,c.finrate,c.finprc,c.gctnm,c.finnt,sum(c.pdtnum)over(partition by c.fintype,c.gctid,c.pdtid) as pdtnum,sum(c.finprccount)over(partition by c.fintype,c.gctid,c.pdtid) as finprccount from tblfinance c where c.bindno is not null and c.fintype=:fintype! and c.notype=:notype! and c.gctnm=:gctnm! and c.pdtid=:pdtid!
fin02_001_2=select distinct c.fintype,c.notype,c.gctid,c.pdtid,c.pdtnm,c.band,c.finrate,c.finprc,c.gctnm,c.finnt,sum(c.pdtnum)over(partition by c.fintype,c.gctid,c.pdtid) as pdtnum,sum(c.finprccount)over(partition by c.fintype,c.gctid,c.pdtid) as finprccount from tblfinance c where c.bindno is null and c.fintype=:fintype! and c.notype=:notype! and c.gctnm=:gctnm! and c.pdtid=:pdtid!

fin02_003=select c.finno,c.fintype,c.notype,c.gctid,c.pdtid,c.pdtnm,c.band,c.finrate,c.finprc,c.gctnm,c.finnt,c.pdtnum as pdtnum,c.finprccount as finprccount from tblfinance c where c.fintype=:fintype! and c.notype=:notype! and c.gctnm=:gctnm! and c.pdtid=:pdtid!
fin02_003_1=select c.finno,c.fintype,c.notype,c.gctid,c.pdtid,c.pdtnm,c.band,c.finrate,c.finprc,c.gctnm,c.finnt,c.pdtnum as pdtnum,c.finprccount as finprccount from tblfinance c where c.bindno is not null and c.fintype=:fintype! and c.notype=:notype! and c.gctnm=:gctnm! and c.pdtid=:pdtid!
fin02_003_2=select c.finno,c.fintype,c.notype,c.gctid,c.pdtid,c.pdtnm,c.band,c.finrate,c.finprc,c.gctnm,c.finnt,c.pdtnum as pdtnum,c.finprccount as finprccount from tblfinance c where c.bindno is null and c.fintype=:fintype! and c.notype=:notype! and c.gctnm=:gctnm! and c.pdtid=:pdtid!

fin02_002=select distinct c.fintype,c.notype,c.gctid,c.pdtid,c.pdtnm,c.band,c.finrate,c.finprc,c.gctnm,c.finnt,sum(c.pdtnum)over(partition by c.fintype,c.gctid,c.pdtid) as pdtnum,sum(c.finprccount)over(partition by c.fintype,c.gctid,c.pdtid) as finprccount,c.invoicecode,c.invoiceno from tblfinance c where c.bindno is null and c.fintype=:fintype! and c.notype=:notype! and c.gctnm=:gctnm! and c.pdtid=:pdtid!
fin02_002_1=select c.finno,c.fintype,c.notype,c.gctid,c.pdtid,c.pdtnm,c.band,c.finrate,c.finprc,c.gctnm,c.finnt,c.pdtnum as pdtnum,c.finprccount as finprccount from tblfinance c where c.bindno is null and c.fintype=:fintype! and c.notype=:notype! and c.gctnm=:gctnm! and c.pdtid=:pdtid!


fin03_001=SELECT DISTINCT g.gctsname,g.taxno,c.invoicecode,c.invoiceno,c.notype,c.pdtnm,c.finnt,SUM(c.pdtnum) OVER(PARTITION BY c.fintype,c.gctid,c.pdtid) AS pdtnum,SUM(c.finprccount) OVER(PARTITION BY c.fintype,c.gctid,c.pdtid) AS finprccount,c.fintype,c.gctid,c.pdtid FROM tblfinance c LEFT JOIN tblgrpclient g ON g.gctid = c.gctid where c.fintype='red' and c.notype=:notype! and c.gctnm=:gctnm! and c.pdtid=:pdtid!
fin03_001_1=SELECT DISTINCT g.gctsname,g.taxno,c.invoicecode,c.invoiceno,c.notype,c.pdtnm,c.finnt,SUM(c.pdtnum) OVER(PARTITION BY c.fintype,c.gctid,c.pdtid) AS pdtnum,SUM(c.finprccount) OVER(PARTITION BY c.fintype,c.gctid,c.pdtid) AS finprccount,c.fintype,c.gctid,c.pdtid FROM tblfinance c LEFT JOIN tblgrpclient g ON g.gctid = c.gctid where c.bindno is not null and c.fintype='red' and c.notype=:notype! and c.gctnm=:gctnm! and c.pdtid=:pdtid!
fin03_001_2=SELECT DISTINCT g.gctsname,g.taxno,c.invoicecode,c.invoiceno,c.notype,c.pdtnm,c.finnt,SUM(c.pdtnum) OVER(PARTITION BY c.fintype,c.gctid,c.pdtid) AS pdtnum,SUM(c.finprccount) OVER(PARTITION BY c.fintype,c.gctid,c.pdtid) AS finprccount,c.fintype,c.gctid,c.pdtid FROM tblfinance c LEFT JOIN tblgrpclient g ON g.gctid = c.gctid where c.bindno is null and c.fintype='red' and c.notype=:notype! and c.gctnm=:gctnm! and c.pdtid=:pdtid!

fin04_001=select f.folno as typeno,g.gctnm,g.gctid,i.ictnm as ictnm,i.ictid AS ictid,p.pdtid as pdtid,p.pdtnm as pdtnm,nvl(r.series,'\u914d\u4ef6') as band,m.tmksid as tmksid,p.pdtprc as pdtprc,(d.fdtdprc*d.fdtdisc) as sellprc,d.fdtqnt as pdtnum,nvl(r.rate,'0.4') as finrate,f.folchgdt as chgdt,(pdtprc*nvl(r.rate,'0.4')) as finprc,(pdtprc*fdtqnt*nvl(r.rate,'0.4')) as finprccount from tblfolio f left join tblfoldetail d on f.folno = d.fdtfno left join tblgrpclient g on g.gctid = f.folctid left join tblproduct p on p.pdtid = d.fdtpid left join tblindclient i on i.ictid = d.fdtcltid left join tblmaking m on d.fdtfno = m.tmkfno left join tblfinrate r on p.pdtnm like '%'||r.band||'%'  where f.folischg='1' and (f.isfinbill is null or f.isfinbill = '0') and (f.foltype='make' or f.foltype='makeEar' or f.foltype='normal') and (f.folsta <> 'recoiled' and f.folsta <> 'recoiledhead' and f.folsta <> 'recpass') and f.folno not in (select distinct typeno from tblfinance where fintype='normal' and notype='order') and f.folchgdt > last_day(add_months(sysdate, -3)) and f.folchgdt < last_day(add_months(sysdate, -2)) and f.foldt > to_date('2011-12-26','yyyy-mm-dd') and r.fpdtnm ='\u52A9\u542C\u5668' and f.folno =:typeno! and g.gctnm =:gctnm! and i.ictnm =:ictnm! and p.pdtid =:pdtid! and f.folchgdt>=:start! and f.folchgdt<=:end!
fin04_002=select n.chgid as typeno,g.gctnm,g.gctid,i.ictnm as ictnm,i.ictid AS ictid,p.pdtid as pdtid,p.pdtnm as pdtnm,nvl(r.series,'\u914d\u4ef6') as band,p.pdtprc as pdtprc,(p.pdtprc*h.ncddis) as sellprc,h.ncdqnt as pdtnum,nvl(r.rate,'0.4') as finrate,n.chgdt as chgdt,(pdtprc*nvl(r.rate,'0.4')) as finprc,(pdtprc*ncdqnt*nvl(r.rate,'0.4')) as finprccount from tblnorchg n left join tblnorchgdetail h on n.chgid = h.ncdid left join tblgrpclient g on g.gctid = n.chggcltid left join tblproduct p on p.pdtid = h.ncdpid left join tblindclient i on i.ictid = n.chgcltid left join tblfinrate r on p.pdtnm like '%'||r.band||'%'  where (n.isfinbill is null or n.isfinbill = '0') and (h.ncdsta <> 'nomrecoiled' and h.ncdsta <> 'commited' and h.ncdsta <> 'pass') and n.chgid not in (select distinct typeno from tblfinance where fintype='normal' and notype='common') and n.chgdt > last_day(add_months(SYSDATE,-3)) and n.chgdt < last_day(add_months(sysdate, -2)) and r.fpdtnm ='\u52A9\u542C\u5668' and n.chgid =:typeno! and g.gctnm =:gctnm! and i.ictnm =:ictnm! and p.pdtid =:pdtid! and n.chgdt>=:start! and n.chgdt<=:end!

fin_insert=insert into tblfinance (finno,fintype,typeno,notype,gctnm,gctid,pdtnm,pdtid,finnt,finsubdt,finpassdt,tmksid,invoicecode,invoiceno,bindno,chgdt,redt,band,finrate,pdtprc,pdtnum,finprccount,finprc,sellprc,fintel,retailname,retailtaxno,ictnm,ictid,comaddr,depositbank,depositid,specialtel) values (:finno!,:fintype!,:typeno!,:notype!,:gctnm!,:gctid!,:pdtnm!,:pdtid!,:finnt!,:finsubdt!,:finpassdt!,:tmksid!,:invoicecode!,:invoiceno!,:bindno!,:chgdt!,:redt!,:band!,:finrate!,:pdtprc!,:pdtnum!,:finprccount!,:finprc!,:sellprc!,:fintel!,:retailname!,:retailtaxno!,:ictnm!,:ictid!,:comaddr!,:depositbank!,:depositid!,:specialtel!)

fin05_001=select * from tblgrpclient where gcttype <> 'G' and gctnm like:gctnm!

config_finrate=select * from tblfinrate order by finrateid